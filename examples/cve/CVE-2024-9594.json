{
  "dataType": "CVE_RECORD",
  "dataVersion": "5.1",
  "cveMetadata": {
    "cveId": "CVE-2024-9594",
    "assignerOrgId": "a6081bf6-c852-4425-ad4f-a67919267565",
    "state": "PUBLISHED",
    "assignerShortName": "kubernetes",
    "dateReserved": "2024-10-07T16:39:37.106Z",
    "datePublished": "2024-10-15T20:37:01.308Z",
    "dateUpdated": "2024-10-16T16:21:56.147Z"
  },
  "containers": {
    "cna": {
      "providerMetadata": {
        "orgId": "a6081bf6-c852-4425-ad4f-a67919267565",
        "shortName": "kubernetes",
        "dateUpdated": "2024-10-15T20:37:01.308Z"
      },
      "datePublic": "2024-10-14T15:25:00.000Z",
      "problemTypes": [
        {
          "descriptions": [
            {
              "lang": "en",
              "cweId": "CWE-798",
              "description": "CWE-798 Use of Hard-coded Credentials",
              "type": "CWE"
            }
          ]
        }
      ],
      "impacts": [
        {
          "capecId": "CAPEC-395",
          "descriptions": [
            {
              "lang": "en",
              "value": "CAPEC-395 Bypassing Electronic Locks and Access Controls"
            }
          ]
        }
      ],
      "affected": [
        {
          "vendor": "Kubernetes",
          "product": "Image Builder",
          "repo": "https://github.com/kubernetes-sigs/image-builder",
          "versions": [
            {
              "status": "affected",
              "version": "0",
              "lessThanOrEqual": "0.1.37",
              "versionType": "semver"
            },
            {
              "status": "unaffected",
              "version": "0.1.38"
            }
          ],
          "defaultStatus": "unaffected"
        }
      ],
      "descriptions": [
        {
          "lang": "en",
          "value": "A security issue was discovered in the Kubernetes Image Builder versions \u003C= v0.1.37 where default credentials are enabled during the image build process when using the Nutanix, OVA, QEMU or raw providers. The credentials can be used to gain root access. The credentials are disabled at the conclusion of the image build process. Kubernetes clusters are only affected if their nodes use VM images created via the Image Builder project. Because these images were vulnerable during the image build process, they are affected only if an attacker was able to reach the VM where the image build was happening and used the vulnerability to modify the image at the time the image build was occurring.",
          "supportingMedia": [
            {
              "type": "text/html",
              "base64": false,
              "value": "\u003Cp\u003EA security issue was discovered in the Kubernetes Image Builder versions &lt;= v0.1.37 where default credentials are enabled during the image build process&nbsp;when using the Nutanix, OVA, QEMU or raw providers. The credentials can be used to gain root access. The credentials are disabled at the conclusion of the image build process. Kubernetes clusters are only affected if their nodes use VM images created via the Image Builder project. Because these images were vulnerable during the image build process, they are affected only if an attacker was able to reach the VM where the image build was happening and used the vulnerability to modify the image at the time the image build was occurring.\u003Cbr\u003E\u003Cbr\u003E\u003C/p\u003E"
            }
          ]
        }
      ],
      "references": [
        {
          "url": "https://github.com/kubernetes/kubernetes/issues/128007",
          "tags": [
            "vendor-advisory",
            "issue-tracking"
          ]
        },
        {
          "url": "https://github.com/kubernetes-sigs/image-builder/pull/1596",
          "tags": [
            "patch"
          ]
        },
        {
          "url": "https://groups.google.com/g/kubernetes-security-announce/c/UKJG-oZogfA/m/Lu1hcnHmAQAJ",
          "tags": [
            "mailing-list"
          ]
        }
      ],
      "metrics": [
        {
          "format": "CVSS",
          "scenarios": [
            {
              "lang": "en",
              "value": "VM Images built via Nutanix, OVA, QEMU or raw provider"
            }
          ],
          "cvssV3_1": {
            "version": "3.1",
            "attackVector": "ADJACENT_NETWORK",
            "attackComplexity": "HIGH",
            "privilegesRequired": "HIGH",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "availabilityImpact": "HIGH",
            "baseSeverity": "MEDIUM",
            "baseScore": 6.3,
            "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H"
          }
        }
      ],
      "solutions": [
        {
          "lang": "en",
          "value": "Rebuild any affected images using a fixed version of Image Builder. Re-deploy the fixed images to any affected VMs.",
          "supportingMedia": [
            {
              "type": "text/html",
              "base64": false,
              "value": "\u003Cp\u003ERebuild any affected images using a fixed version of Image Builder. Re-deploy the fixed images to any affected VMs.\u003C/p\u003E"
            }
          ]
        }
      ],
      "credits": [
        {
          "lang": "en",
          "value": "Nicolai Rybnikar @rybnico from Rybnikar Enterprises GmbH.",
          "type": "reporter"
        }
      ],
      "source": {
        "discovery": "EXTERNAL"
      },
      "x_generator": {
        "engine": "Vulnogram 0.2.0"
      },
      "title": "VM images built with Image Builder with some providers use default credentials during builds"
    },
    "adp": [
      {
        "affected": [
          {
            "vendor": "kubernetes",
            "product": "image_builder",
            "cpes": [
              "cpe:2.3:a:kubernetes:image_builder:*:*:*:*:*:*:*:*"
            ],
            "defaultStatus": "unknown",
            "versions": [
              {
                "version": "0",
                "status": "affected",
                "lessThan": "0.1.38",
                "versionType": "semver"
              }
            ]
          }
        ],
        "metrics": [
          {
            "other": {
              "type": "ssvc",
              "content": {
                "timestamp": "2024-10-16T16:20:46.180323Z",
                "id": "CVE-2024-9594",
                "options": [
                  {
                    "Exploitation": "none"
                  },
                  {
                    "Automatable": "no"
                  },
                  {
                    "Technical Impact": "total"
                  }
                ],
                "role": "CISA Coordinator",
                "version": "2.0.3"
              }
            }
          }
        ],
        "title": "CISA ADP Vulnrichment",
        "providerMetadata": {
          "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
          "shortName": "CISA-ADP",
          "dateUpdated": "2024-10-16T16:21:56.147Z"
        }
      }
    ]
  }
}

